(function(){"use strict";let e;const m=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});m.decode();let b=new Uint8Array;function g(){return b.byteLength===0&&(b=new Uint8Array(e.memory.buffer)),b}function w(n,t){return m.decode(g().subarray(n,n+t))}let c=0;const u=new TextEncoder("utf-8"),h=typeof u.encodeInto=="function"?function(n,t){return u.encodeInto(n,t)}:function(n,t){const o=u.encode(n);return t.set(o),{read:n.length,written:o.length}};function f(n,t,o){if(o===void 0){const s=u.encode(n),d=t(s.length);return g().subarray(d,d+s.length).set(s),c=s.length,d}let r=n.length,a=t(r);const i=g();let _=0;for(;_<r;_++){const s=n.charCodeAt(_);if(s>127)break;i[a+_]=s}if(_!==r){_!==0&&(n=n.slice(_)),a=o(a,r,r=_+n.length*3);const s=g().subarray(a+_,a+r),d=h(n,s);_+=d.written}return c=_,a}function v(n){const t=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),o=c;e.greet(t,o)}let y=new Int32Array;function l(){return y.byteLength===0&&(y=new Int32Array(e.memory.buffer)),y}function A(n){try{const r=e.__wbindgen_add_to_stack_pointer(-16),a=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),i=c;e.parse_fen(r,a,i);var t=l()[r/4+0],o=l()[r/4+1];return w(t,o)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(t,o)}}function k(n){try{const r=e.__wbindgen_add_to_stack_pointer(-16),a=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),i=c;e.get_squares(r,a,i);var t=l()[r/4+0],o=l()[r/4+1];return w(t,o)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(t,o)}}function I(n,t){try{const a=e.__wbindgen_add_to_stack_pointer(-16),i=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),_=c;e.search_good_move(a,i,_,t);var o=l()[a/4+0],r=l()[a/4+1];return w(o,r)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(o,r)}}function W(n,t){try{const a=e.__wbindgen_add_to_stack_pointer(-16),i=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),_=c,s=f(t,e.__wbindgen_malloc,e.__wbindgen_realloc),d=c;e.push_unchecked_move(a,i,_,s,d);var o=l()[a/4+0],r=l()[a/4+1];return w(o,r)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(o,r)}}function M(n,t,o){try{const i=e.__wbindgen_add_to_stack_pointer(-16),_=f(n,e.__wbindgen_malloc,e.__wbindgen_realloc),s=c,d=f(o,e.__wbindgen_malloc,e.__wbindgen_realloc),E=c;e.get_available_moves_at_index(i,_,s,t,d,E);var r=l()[i/4+0],a=l()[i/4+1];return w(r,a)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(r,a)}}async function x(n,t){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,t)}catch(r){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const o=await n.arrayBuffer();return await WebAssembly.instantiate(o,t)}else{const o=await WebAssembly.instantiate(n,t);return o instanceof WebAssembly.Instance?{instance:o,module:n}:o}}function R(){const n={};return n.wbg={},n.wbg.__wbg_alert_b104b2d27a3fa2a1=function(t,o){alert(w(t,o))},n.wbg.__wbindgen_throw=function(t,o){throw new Error(w(t,o))},n}function U(n,t){return e=n.exports,p.__wbindgen_wasm_module=t,y=new Int32Array,b=new Uint8Array,e}async function p(n){typeof n>"u"&&(n=new URL("/crust/assets/crust_bg.275a712e.wasm",self.location));const t=R();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:o,module:r}=await x(await n,t);return U(o,r)}const S={greet:v,parse_fen:A,get_squares:k,search_good_move:I,get_available_moves_at_index:M,push_unchecked_move:W},T=p();onmessage=async n=>{await T;const{id:t,fn:o,params:r}=n.data,a=await S[o](...r);postMessage({id:t,res:a})}})();
